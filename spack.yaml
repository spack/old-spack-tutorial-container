spack:
  definitions:
  - bootstrapped_compilers:
    - "llvm@6.0.0 os=centos7"
    - "gcc@7.2.1 os=centos7"
    - "gcc@8.3.0 os=centos7"
  - gcc_system_packages:
    - matrix:
      - - zlib
        - zlib@1.2.8
        - zlib@1.2.8 cppflags=-O3
        - tcl
        - tcl ^zlib@1.2.8 cppflags=-O3
        - hdf5
        - hdf5~mpi
        - hdf5+hl+mpi ^mpich
        - trilinos
        - trilinos +hdf5 ^hdf5+hl+mpi ^mpich
        - gcc@8.3.0
        - mpileaks
        - lmod
      - ['%gcc@4.8.5']
  - gcc_old_packages:
    - zlib%gcc@7.2.1
  - clang_packages:
    - matrix:
      - [zlib, tcl ^zlib@1.2.8]
      - ['%clang@6.0.0']
  - gcc_spack_built_packages:
    - matrix:
      - [netlib-scalapack]
      - [^mpich, ^openmpi]
      - [^openblas, ^netlib-lapack]
      - ['%gcc@8.3.0']
    - matrix:
      - [py-scipy^openblas, armadillo^openblas, netlib-lapack, openmpi, mpich, elpa^mpich]
      - ['%gcc@8.3.0']
  specs:
  - $gcc_system_packages
  - $gcc_old_packages
  - $clang_packages
  - $gcc_spack_built_packages

  mirrors:
    cloud_mirror: 's3://spack-tutorial-container/mirror-centos7'

  gitlab-ci:
    bootstrap:
      - name: bootstrapped_compilers
        compiler-agnostic: true
    mappings:
    - match: [llvm]
      runner-attributes:
        image:
          name: spack/centos7
          entrypoint: ['']
        tags: [spack-kube, r5.2xlarge]
        variables: {}
    - match: [trilinos, gcc]
      runner-attributes:
        image:
          name: spack/centos7
          entrypoint: ['']
        tags: [spack-kube, large]
        variables: {}
    - match: [os=centos7]
      runner-attributes:
        image:
          name: spack/centos7
          entrypoint: ['']
        tags: [spack-kube, medium]
        variables: {}
    final-stage-rebuild-index:
      tags: [spack-kube]
      image:
        name: spack/centos7
        entrypoint: ['']
    enable-debug-messages: True

  cdash:
    build-group: Spack v0.15.1 (Centos7) Tutorial Container
    url: https://cdash.spack.io
    project: Spack
    site: Spack Gitlab Cloud Infrastructure

  view: false
  config:
    install_tree: /home/software/$padding:512
  modules:
    enable: []
  packages:
    all:
      target: [x86_64]
  repos: []
  upstreams: {}
  concretization: separately
